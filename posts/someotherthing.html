
<!DOCTYPE html>
<html>
<head>
<title>Solution 2</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<style type="text/css">
body { font-family: arial, sans-serif; line-height: 1.6em; margin: 2em; }
#main { max-width: 1100px; margin-left: auto; margin-right: auto; }
p { text-align:justify; text-justify:inter-word; }
table { border-collapse:collapse; }
table, th, td { border: 1px solid #aaa; }
th, td { padding:0.3em; }
</style>
</head>
<body>


<div id="main">
<h1>Solution 2</h1>
<p><i>April 3, 2019</i></p>

<p>
Let's assume that we know the length of the jump, and it is equal to $l$. Then, in order to be back at the starting point, Sergey will need to make exactly $n \cdot k / gcd(n \cdot k, l)$ moves, where $gcd$ is the greatest common divider.
</p>

<p>
Let $l = kx + c$, where $c$ and $x$ are non-negative integers. So, if we know $a$ and $b$, than $c$ can only take $4$ values: $((a + b) \% c, (a - b) \% c, (b - a) \% c, (-a - b) \% c)$, where $\% c$ means modulo $c$. It is clear that only $x < n$ can be considered. Then we iterate over all the $4n$ variants of the pair $(x, c)$, and for each we find the number of moves to the starting point. The minimum and maximum of the resulting numbers will be the answer.
</p>

<pre style='color:#000000;background:#ffffff;'><span style='color:#004a43; '>#</span><span style='color:#004a43; '>include </span><span style='color:#800000; '>&lt;</span><span style='color:#40015a; '>bits/stdc++.h</span><span style='color:#800000; '>></span>
<span style='color:#800000; font-weight:bold; '>using</span> <span style='color:#800000; font-weight:bold; '>namespace</span> <span style='color:#666616; '>std</span><span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>int</span> ans<span style='color:#808030; '>[</span><span style='color:#808030; '>]</span> <span style='color:#808030; '>=</span> <span style='color:#800080; '>{</span><span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>0</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>21</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>85</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>73</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>341</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>89</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1365</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5461</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>4681</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>21845</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>87381</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>349525</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>299593</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1398101</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>178481</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>5592405</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1082401</span><span style='color:#800080; '>}</span><span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>int</span> solve<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>int</span> n<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
	<span style='color:#800000; font-weight:bold; '>if</span><span style='color:#808030; '>(</span>__builtin_popcount<span style='color:#808030; '>(</span>n <span style='color:#808030; '>+</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>return</span> ans<span style='color:#808030; '>[</span><span style='color:#008c00; '>32</span> <span style='color:#808030; '>-</span> __builtin_clz<span style='color:#808030; '>(</span>n<span style='color:#808030; '>)</span><span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>
	<span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span> <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> <span style='color:#808030; '>(</span><span style='color:#008c00; '>32</span> <span style='color:#808030; '>-</span> __builtin_clz<span style='color:#808030; '>(</span>n<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>-</span> <span style='color:#008c00; '>1</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>

<span style='color:#800000; font-weight:bold; '>int</span> <span style='color:#400000; '>main</span><span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>int</span> argc<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>char</span> <span style='color:#800000; font-weight:bold; '>const</span> <span style='color:#808030; '>*</span>argv<span style='color:#808030; '>[</span><span style='color:#808030; '>]</span><span style='color:#808030; '>)</span>
<span style='color:#800080; '>{</span>
	<span style='color:#696969; '>// freopen("in", "r", stdin);</span>
	<span style='color:#800000; font-weight:bold; '>int</span> q<span style='color:#800080; '>;</span> <span style='color:#603000; '>cin</span> <span style='color:#808030; '>></span><span style='color:#808030; '>></span> q<span style='color:#800080; '>;</span>
	<span style='color:#800000; font-weight:bold; '>while</span><span style='color:#808030; '>(</span>q<span style='color:#808030; '>-</span><span style='color:#808030; '>-</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
		<span style='color:#800000; font-weight:bold; '>int</span> n<span style='color:#800080; '>;</span> <span style='color:#603000; '>cin</span> <span style='color:#808030; '>></span><span style='color:#808030; '>></span> n<span style='color:#800080; '>;</span>
		<span style='color:#603000; '>cout</span> <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> solve<span style='color:#808030; '>(</span>n<span style='color:#808030; '>)</span> <span style='color:#808030; '>&lt;</span><span style='color:#808030; '>&lt;</span> <span style='color:#603000; '>endl</span><span style='color:#800080; '>;</span>
	<span style='color:#800080; '>}</span>
	<span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#008c00; '>0</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
</pre>
<!--Created using ToHtml.com on 2019-04-03 16:14:43 UTC -->

</div>

<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    MMLorHTML: { prefer: "HTML" },
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });</script>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type='text/javascript'>
  newContainer = document.createElement('span');
  newContainer.style.setProperty("display","none","");
  newNode = document.createElement('script');
  newNode.type = "math/tex";
  newContainer.appendChild(newNode);
  document.body.insertBefore(newContainer,document.body.firstChild);
</script>


</body>
</html>
