<!DOCTYPE html>
<html>
    <head>
        <meta name=viewport content="width=device-width,initial-scale=1">
        <meta charset="utf-8"/>
        <script src="https://cdn.geogebra.org/apps/deployggb.js"></script>
        <title>Knuth-Morris-Pratt String Matching</title>
        <script type='text/x-mathjax-config'>
            MathJax.Hub.Config({
                extensions: ["tex2jax.js"],
                jax: ["input/TeX", "output/HTML-CSS"],
                MMLorHTML: { prefer: "HTML" },
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true
                },
                "HTML-CSS": { availableFonts: ["TeX"] },
                TeX: { equationNumbers: { autoNumber: "AMS" } }
            });
        </script>
        <script type="text/javascript" async
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
        </script>
        <link rel="stylesheet" href="../css/style.css">
    </head>

    <body>
        <h1>Knuth-Morris-Pratt String Matching</h1>
        <h4><i>December 6, 2019</i></h4>

        <p>
            <b>Motivation. </b> Given two strings $T$ and $P$, find the number of occurence of $P$ in $T$ <i>i.e.</i> number of substrings of $T$ which are equal to $P$.
        </p>

        <p>Every indexing is $0$-based.</p>

        <h3>The $\pi$ Array</h3>

        <p>
            Proper prefix/suffix of a string is a prefix/suffix of that string which is just not the whole string (the whole string is its prefix/suffix, right?... but not a proper prefix/suffix).
        </p>

        <p>
            $\pi_S[i]$ = length of the longest proper prefix of $S[0...i]$ which is also its suffix. If there's none, then $\pi_S[i] = 0$ (the empty prefix!).
        </p>

        <p>
            Why do we care about this $\pi$ array? Let $Q = P + ``\#" + T$ and calculate $\pi_Q$. Now, $\forall i \in \left [ |P|+1, |Q|-1 \right ]$, if $\pi_Q[i] = |P|$, then we have a matching of $P$ in $T$ which starts from $T[i - (|P|+1) - |P|]$. Although, I don't think that this was the main motivation to find out $\pi$ arrays of strings in the first place.
        </p>

        <h3>Calculating The $\pi$ Array (for some string $S$)</h3>

        <p>
            I'd like to think this as some kind of induction-ish approach.
        </p>

        <p>
            Undoubtedly, $\pi[0] = 0$.
        </p>

        <p>
            Now, suppose we have calculated $\pi[0...k]$. And we want to calculate $\pi[k+1]$.
        </p>



        <p>
            <script src="https://ideone.com/e.js/sT8Vd1" type="text/javascript" ></script>
        </p>

        <div id="ggbApplet"></div>

        <script>
        var parameters = {
        "id": "ggbApplet",
        "width":1569,
        "height":669,
        "showMenuBar":true,
        "showAlgebraInput":true,
        "showToolBar":true,
        "customToolBar":"0 73 62 | 1 501 67 , 5 19 , 72 75 76 | 2 15 45 , 18 65 , 7 37 | 4 3 8 9 , 13 44 , 58 , 47 | 16 51 64 , 70 | 10 34 53 11 , 24  20 22 , 21 23 | 55 56 57 , 12 | 36 46 , 38 49  50 , 71  14  68 | 30 29 54 32 31 33 | 25 17 26 60 52 61 | 40 41 42 , 27 28 35 , 6",
        "showToolBarHelp":true,
        "showResetIcon":false,
        "enableLabelDrags":false,
        "enableShiftDragZoom":true,
        "enableRightClick":false,
        "errorDialogsActive":false,
        "useBrowserForJS":false,
        "allowStyleBar":false,
        "preventFocus":false,
        "showZoomButtons":true,
        "capturingThreshold":3,
        // add code here to run when the applet starts
        "appletOnLoad":function(api){ /* api.evalCommand('Segment((1,2),(3,4))');*/ },
        "showFullscreenButton":true,
        "scale":1,
        "disableAutoScale":false,
        "allowUpscale":false,
        "clickToLoad":false,
        "appName":"classic",
        "showSuggestionButtons":true,
        "buttonRounding":0.7,
        "buttonShadows":false,
        "language":"en",
        // use this instead of ggbBase64 to load a material from geogebra.org
        // "material_id":"RHYH3UQ8",
        // use this instead of ggbBase64 to load a .ggb file
        // "filename":"myfile.ggb",
        "ggbBase64":"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",
        };
        // is3D=is 3D applet using 3D view, AV=Algebra View, SV=Spreadsheet View, CV=CAS View, EV2=Graphics View 2, CP=Construction Protocol, PC=Probability Calculator DA=Data Analysis, FI=Function Inspector, macro=Macros
        var views = {'is3D': 0,'AV': 1,'SV': 0,'CV': 0,'EV2': 0,'CP': 0,'PC': 0,'DA': 0,'FI': 0,'macro': 0};
        var applet = new GGBApplet(parameters, '5.0', views);
        window.onload = function() {applet.inject('ggbApplet')};
        applet.setPreviewImage('data:image/gif;base64,R0lGODlhAQABAAAAADs=','https://www.geogebra.org/images/GeoGebra_loading.png','https://www.geogebra.org/images/applet_play.png');
        </script>

    </body>
</html>
